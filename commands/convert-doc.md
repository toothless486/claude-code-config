# DOC/DOCX to Markdown 변환 Command

Microsoft Word 문서(.doc, .docx)를 Markdown 파일(.md)로 변환한다.

## 사용법
```
/convert-doc <file-path>
```
- `<file-path>`: 변환할 .doc 또는 .docx 파일 경로
- 필수 입력

## 입력 파일
$ARGUMENTS

## 실행 절차

### 1. 입력 파일 확인
```bash
file "<file-path>"
```
- 파일 존재 여부 확인
- 파일 타입 확인 (.doc 또는 .docx)

### 2. 파일 내용 추출

#### .doc 파일 (Compound Document)
Python을 사용하여 바이너리 파일에서 텍스트 추출:
```python
with open(doc_file, 'rb') as f:
    content = f.read()
# UTF-16LE 디코딩으로 텍스트 추출
decoded = content.decode('utf-16le', errors='ignore')
```

#### .docx 파일
가능한 경우 python-docx 또는 pandoc 사용:
```bash
pandoc -f docx -t markdown "<file-path>"
```

### 3. 문서 구조 분석
추출된 텍스트에서 다음 요소를 식별:
- 제목 및 헤더
- 표 (테이블)
- 목록 (순서있는/없는)
- 본문 텍스트
- 메타데이터 (작성자, 날짜 등)

### 4. Markdown 변환 규칙

#### 제목/헤더
- 문서 제목 → `# 제목`
- 섹션 제목 → `## 섹션`
- 하위 섹션 → `### 하위 섹션`

#### 표 (테이블)
```markdown
| 헤더1 | 헤더2 | 헤더3 |
|-------|-------|-------|
| 값1   | 값2   | 값3   |
```

#### 목록
- 순서 없는 목록 → `- 항목`
- 순서 있는 목록 → `1. 항목`

#### 코드/다이어그램
- ASCII 다이어그램이나 코드 블록은 코드 펜스로 감싸기:
```
​```
코드 또는 다이어그램
​```
```

### 5. 출력 파일 생성

#### 출력 파일 경로
- 원본 파일과 동일한 디렉토리
- 확장자만 `.md`로 변경
- 예: `문서.doc` → `문서.md`

#### 파일 인코딩
- UTF-8로 저장

### 6. 변환 완료 보고
- 출력 파일 경로 표시
- 변환된 문서의 주요 섹션 요약

## 문서 유형별 처리

### 보완내역서 (LGU+ VSaaS)
다음 구조로 변환:
```markdown
# {시스템명} {버전} 보완내역서 - {모듈명}

## 문서 정보
| 항목 | 내용 |
|------|------|
| 시스템명 | ... |
| 관리번호 | ... |
...

## 구분
| 항목 | 선택 |
|------|------|
...

## 보완블록
...

## 배경 및 요구사항
...

## 보완내역
...

## 영향도 분석
...

## 시험
...
```

### 일반 문서
문서 구조를 분석하여 적절한 Markdown 헤더 레벨과 포맷 적용

## 참고사항

- .doc 파일은 바이너리 형식이므로 일부 서식 정보가 손실될 수 있다
- 복잡한 표나 이미지는 수동 확인이 필요할 수 있다
- 한글(Korean) 텍스트 인코딩에 주의 (EUC-KR, UTF-16LE 등)
- 변환 후 결과물을 검토하여 필요시 수정한다

## 에러 처리

| 에러 상황 | 처리 방법 |
|-----------|-----------|
| 파일 없음 | 오류 메시지 출력 후 종료 |
| 지원하지 않는 형식 | .doc/.docx 파일만 지원함을 안내 |
| 텍스트 추출 실패 | 대체 방법(strings 명령어 등) 시도 |
| 인코딩 오류 | 다양한 인코딩으로 재시도 |
